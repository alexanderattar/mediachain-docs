<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">

        <title>Mediachain : Controlling a remote node with SSH Tunneling</title>
        <meta name="description" content="Docs for the Mediachain Project">

        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/css/syntax.css">
        <link rel="stylesheet" href="/css/main.css">
        <link rel="shortcut icon" type="image/png" href="/favicon.png"/>
        <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    </head>
    <body>

        <div class="container">
            <div class="row">
                <div id="header" class="col-sm-12">
                    <h4><a class="brand" href="/">Mediachain</a>
    <small>Docs for the Mediachain Project</small>
</h4>

                </div>
            </div>

            <div class="row">
                <div id="navigation" class="col-sm-3">
                    <ul class="nav nav-list">
    
      
      
      <h4>Installation and Setup</h4>
      
      
        <li>
          <a href="/install">Installing Mediachain</a>
          
        </li>
      
        <li>
          <a href="/cloud-deploy">Using Mediachain Deploy</a>
          
        </li>
      
        <li>
          <a href="/getting-started">Getting Started</a>
          
        </li>
      
        <li>
          <a href="/nat">Configuring NAT Traversal</a>
          
        </li>
      
        <li>
          <a href="/ssh-tunnel">Controlling a remote node with SSH Tunneling</a>
          
            <div id="nav_current"></div>
          
        </li>
      
    
      
      
      <h4>Using Mediachain</h4>
      
      
        <li>
          <a href="/basic-operations">Basic Operations</a>
          
        </li>
      
        <li>
          <a href="/advanced-operations">Advanced Operations</a>
          
        </li>
      
    
      
      
      <h4>Publishing Data</h4>
      
      
        <li>
          <a href="/schema-recommendations">Recommended Schemas</a>
          
        </li>
      
    
      
      
      <h4>Mediachain Architecture</h4>
      
      
        <li>
          <a href="/statements-and-objects">Statements and Objects</a>
          
        </li>
      
        <li>
          <a href="/mcql">MCQL</a>
          
        </li>
      
    
<!-- List additional links. It is recommended to add a divider
    e.g. <li class="divider"></li> first to break up the content. -->
</ul>

                </div>

                <div id="content" class="col-sm-9">
                    <div class="page-header">
    <h1>Controlling a remote node with SSH Tunneling
        
    </h1>
</div>

<ul id="table_of_contents">
  <li><a href="#creating-an-ssh-configuration-file-manually">Creating an SSH configuration file manually</a>    <ul>
      <li><a href="#optional-fields">Optional fields</a></li>
    </ul>
  </li>
  <li><a href="#manually-creating-a-tunnel-with-ssh">Manually creating a tunnel with SSH</a></li>
</ul>

<p>To control a <a href="https://github.com/mediachain/concat">concat</a> <code>mcnode</code> running on a remote machine, you can configure <code>mcclient</code> to
automatically create a secure “tunnel” to the remote machine using SSH.   This document assumes that
you have <code>mcclient</code> installed.  If not, see the <a href="/install">install instructions</a>.</p>

<p>All you need is a configuration file to let <code>mcclient</code> know how to reach your node and log in. If
you used  <a href="/cloud-deploy">Mediachain Deploy</a> to create your server, the credentials file that you
downloaded at the end of the Deploy process can be used directly to set up the tunnel.
Let’s say you’ve saved the credentials file for a node with the IP address <code>67.205.161.186</code> to
a <code>~/mediachain/mediachain_node_67.205.161.186.json</code>.  Just pass in that path with the <code>--sshConfig</code>
flag when you run <code>mcclient</code>:</p>

<pre><code>$ mcclient --sshConfig ~/mediachain/mediachain_node_67.205.161.186.json id
Peer ID: QmQD6ZkWFQWsAt3hA71V9zjCyphQ7q62sWAYwPrUMXTnaN
Publisher ID: 4XTTMBoNJsmDEhKYRypFbcUwxvny5w57syL6KDbhUFX7yCnjp
Info:
</code></pre>

<h2 id="creating-an-ssh-configuration-file-manually">Creating an SSH configuration file manually</h2>

<p>To tunnel to a server that you’ve set up yourself without Mediachain Deploy, you can create
a simple JSON file containing an object with these fields:</p>

<ul>
  <li><code>host</code>: the IP address or hostname of the remote server</li>
  <li><code>username</code>: the username of the user running the <code>mcnode</code> daemon</li>
  <li>either <code>password</code> or <code>privateKey</code>
    <ul>
      <li>if <code>privateKey</code> is given, it should be the full contents of your SSH private key file as a
  JSON string, not a file path.  Be careful about newlines, which need to be encoded as <code>\n</code> in
  the JSON string.  If you have the excellent <a href="https://stedolan.github.io/jq">jq</a> installed,
  you can use this one-liner to get the correct formatting: <code>cat ~/.ssh/id_rsa | jq -Rs .</code></li>
    </ul>
  </li>
</ul>

<h4 id="optional-fields">Optional fields</h4>

<p>If your remote <code>mcnode</code> has its API server bound to a non-standard port, you can use the
<code>dstPort</code> field, e.g. <code>dstPort: 6789</code>. If you do use a non-standard <code>dstPort</code>, it’s a good
idea to also set <code>localPort: 9002</code>, which will bind the tunnel to the default local port of 9002,
so that <code>mcclient</code> can find the tunnel at the default location.  </p>

<h2 id="manually-creating-a-tunnel-with-ssh">Manually creating a tunnel with SSH</h2>

<p>It’s also possible to use the <code>ssh</code> tool to create the tunnel, instead of letting <code>mcclient</code> create
it for you.  To do so, open a new terminal and enter this command, replacing <code>&lt;username&gt;</code> with the
remote username and <code>&lt;ip-or-hostname&gt;</code> with the address of your remote server:</p>

<pre><code>ssh -nNT -L 9002:localhost:9002 &lt;username&gt;@&lt;ip-or-hostname&gt;
</code></pre>

<p>After successfully logging in, there won’t be any output; that’s normal! Just open a new terminal
and use <code>mcclient</code> as if <code>mcnode</code> were running on your local machine.</p>



                </div>
            </div>

            <div class="row">
                <div id="footer" class="col-sm-12">
                    <a href="http://images.mediachain.io">Attribution Engine</a>
<a class="pl12" href="http://slack.mediachain.io">Slack</a>
<a href="https://github.com/mediachain">Github</a>
<a href="https://blog.mediachain.io">Blog</a>
<a href="https://twitter.com/mediachain_">Twitter</a>

                </div>
            </div>
        </div>
        

        <script type="text/javascript">
          $(function() {
            var toc = $('#table_of_contents');
            if (toc != null) {
              $('#nav_current').append(toc);
              toc.toggle(true);
            }
          })
        </script>
    </body>
</html>
